<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Universal PDF Converter</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    function updateOptions() {
      const mode = document.getElementById('mode').value;
      const protectOptions = document.getElementById('protect-options');
      if (mode === 'protect') {
        protectOptions.style.display = 'block';
      } else {
        protectOptions.style.display = 'none';
      }
    }
  </script>
</head>

<body>

  <header>
    <div class="logo">Online PDF-Converter</div>
    <nav>
      {% if user %}
      <span>Hello, {{ user.login }}</span>
      <a href="{{ url_for('logout') }}">LOGOUT</a>
      {% else %}
      <a href="{{ url_for('login') }}">LOGIN WITH GITHUB</a>
      {% endif %}
    </nav>
  </header>

  <div class="container">

    <div style="text-align: center; margin-bottom: 30px;">
      <h1 style="color: #b00; margin-bottom: 5px;">Universal PDF Tool</h1>
      <p>Convert, Merge, Protect and Extract. All in one place.</p>
    </div>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div class="flash">
      {% for message in messages %}
      <p style="margin: 0;">{{ message }}</p>
      {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <form action="/convert" method="post" enctype="multipart/form-data">

      <!-- Step 1 -->
      <div class="step-box">
        <div class="step-number">1</div>
        <div class="step-content">
          <h2>Select your files</h2>
          {% if user %}
          <div class="file-drop-area">
            <input type="file" name="files" multiple required
              style="width: 100%; height: 100px; opacity: 0; position: absolute; cursor: pointer;">
            <p style="margin-top: -80px;">Drag & Drop files here or <b>Click to Select</b></p>
            <p style="font-size: 0.8rem; color: #888;">Supports: PDF, EPUB, JPG, PNG (Max 150 MB)</p>
          </div>
          {% else %}
          <p>Please <a href="{{ url_for('login') }}" style="color: #b00; font-weight: bold;">Login</a> to upload files.
          </p>
          {% endif %}
        </div>
      </div>

      <!-- Step 2 -->
      <div class="step-box">
        <div class="step-number">2</div>
        <div class="step-content">
          <h2>Mode & Options</h2>
          <div class="options-grid">
            <div class="option-group">
              <label for="mode">Action:</label>
              <select name="mode" id="mode" onchange="updateOptions()" style="width: 100%;">
                <option value="pdf">Convert to PDF</option>
                <option value="merge">Merge into one PDF</option>
                <option value="text">Extract Text (from PDF)</option>
                <option value="protect">Protect PDF (Add Password)</option>
              </select>
            </div>

            <div id="protect-options" class="option-group" style="display: none;">
              <label for="password">Set Password:</label>
              <input type="password" name="password" placeholder="Enter password" style="width: 90%;">
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="step-box" style="background: transparent; border: none; box-shadow: none; justify-content: center;">
        {% if user %}
        <button type="submit" class="convert-btn">Convert</button>
        {% else %}
        <button type="button" class="convert-btn" style="background: #ccc; cursor: not-allowed;" disabled>Login to
          Convert</button>
        {% endif %}
      </div>

    </form>

  </div>

</body>

</html>